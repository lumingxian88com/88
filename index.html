<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>539 走勢圖 - 平板專用版</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background-color: #f4f4f4; margin: 0; padding: 10px; font-family: sans-serif; }
        .chart-box { background: white; border-radius: 8px; padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        /* 增加高度，方便平板垂直捲動查看 */
        .chart-wrapper { width: 100%; height: 3500px; position: relative; }
    </style>
</head>
<body>
    <div class="chart-box">
        <h2 style="text-align: center;">539 數據分佈 (數據已固定)</h2>
        <div class="chart-wrapper">
            <canvas id="lottoChart"></canvas>
        </div>
    </div>

    <script>
        // 直接將數據放在這裡，不依賴外部 ny.js
        const a = [
            {"de":"2026-01-16","ns":["18","19","22","27","29"]},
            {"de":"2026-01-15","ns":["01","02","03","19","36"]},
            {"de":"2026-01-14","ns":["01","02","16","33","35"]},
            {"de":"2026-01-13","ns":["06","16","17","19","31"]},
            {"de":"2026-01-12","ns":["03","13","18","24","30"]},
            {"de":"2026-01-10","ns":["11","25","26","34","38"]},
            {"de":"2026-01-09","ns":["01","12","14","22","34"]},
            {"de":"2026-01-08","ns":["03","08","10","21","30"]},
            {"de":"2026-01-07","ns":["05","10","14","15","28"]},
            {"de":"2026-01-06","ns":["01","02","06","11","33"]},
            {"de":"2026-01-05","ns":["10","16","18","34","39"]},
            {"de":"2026-01-03","ns":["22","23","31","32","38"]},
            {"de":"2026-01-02","ns":["17","18","25","36","39"]},
            {"de":"2026-01-01","ns":["15","16","18","29","36"]},
            {"de":"2025-12-31","ns":["08","10","11","26","35"]},
            {"de":"2025-12-30","ns":["11","12","24","27","33"]},
            {"de":"2025-12-29","ns":["05","10","13","29","37"]},
            {"de":"2025-12-27","ns":["01","15","19","28","38"]},
            {"de":"2025-12-26","ns":["01","10","20","27","36"]},
            {"de":"2025-12-25","ns":["14","18","28","36","39"]},
            {"de":"2025-12-24","ns":["02","03","14","25","30"]},
            {"de":"2025-12-23","ns":["09","22","24","30","35"]},
            {"de":"2025-12-22","ns":["02","22","24","27","38"]},
            {"de":"2025-12-20","ns":["01","05","16","35","38"]},
            {"de":"2025-12-19","ns":["12","16","23","27","30"]},
            {"de":"2025-12-18","ns":["04","09","32","33","36"]},
            {"de":"2025-12-17","ns":["05","06","07","19","32"]},
            {"de":"2025-12-16","ns":["02","10","14","33","35"]},
            {"de":"2025-12-15","ns":["03","17","27","29","38"]},
            {"de":"2025-12-13","ns":["02","09","21","31","38"]},
            {"de":"2025-12-12","ns":["10","24","26","28","35"]},
            {"de":"2025-12-11","ns":["02","06","17","25","26"]},
            {"de":"2025-12-10","ns":["04","07","11","16","26"]},
            {"de":"2025-12-09","ns":["07","08","15","30","39"]},
            {"de":"2025-12-08","ns":["05","23","27","28","31"]},
            {"de":"2025-12-06","ns":["06","22","23","24","32"]},
            {"de":"2025-12-05","ns":["02","03","16","17","29"]},
            {"de":"2025-12-04","ns":["01","07","20","25","37"]},
            {"de":"2025-12-03","ns":["05","09","14","33","35"]},
            {"de":"2025-12-02","ns":["02","05","08","13","29"]},
            {"de":"2025-12-01","ns":["02","03","04","20","24"]},
            {"de":"2025-11-29","ns":["08","27","30","33","36"]},
            {"de":"2025-11-28","ns":["08","13","14","22","28"]},
            {"de":"2025-11-27","ns":["07","19","22","25","28"]},
            {"de":"2025-11-26","ns":["07","13","26","28","34"]},
            {"de":"2025-11-25","ns":["09","30","36","38","39"]},
            {"de":"2025-11-24","ns":["02","04","05","17","31"]},
            {"de":"2025-11-22","ns":["10","13","32","33","37"]},
            {"de":"2025-11-21","ns":["05","10","17","28","35"]},
            {"de":"2025-11-20","ns":["01","05","33","36","38"]},
            {"de":"2025-11-19","ns":["03","11","20","28","31"]},
            {"de":"2025-11-18","ns":["14","24","31","36","37"]},
            {"de":"2025-11-17","ns":["04","07","16","26","29"]},
            {"de":"2025-11-15","ns":["12","20","25","28","29"]},
            {"de":"2025-11-14","ns":["02","11","15","37","38"]},
            {"de":"2025-11-13","ns":["13","18","20","23","36"]},
            {"de":"2025-11-12","ns":["01","04","09","14","22"]},
            {"de":"2025-11-11","ns":["05","19","31","34","39"]},
            {"de":"2025-11-10","ns":["07","14","15","17","30"]},
            {"de":"2025-11-08","ns":["07","08","09","26","34"]},
            {"de":"2025-11-07","ns":["22","27","30","32","37"]},
            {"de":"2025-11-06","ns":["07","24","28","31","32"]},
            {"de":"2025-11-05","ns":["11","14","15","27","39"]},
            {"de":"2025-11-04","ns":["01","07","12","29","39"]},
            {"de":"2025-11-03","ns":["24","25","34","36","37"]},
            {"de":"2025-11-01","ns":["08","12","19","27","28"]},
            {"de":"2025-10-31","ns":["11","18","25","26","33"]},
            {"de":"2025-10-30","ns":["05","27","28","31","37"]},
            {"de":"2025-10-29","ns":["26","32","33","36","39"]},
            {"de":"2025-10-28","ns":["18","20","25","29","31"]},
            {"de":"2025-10-27","ns":["03","20","26","31","37"]},
            {"de":"2025-10-25","ns":["03","04","11","21","34"]},
            {"de":"2025-10-24","ns":["08","11","13","37","38"]},
            {"de":"2025-10-23","ns":["08","15","27","37","38"]},
            {"de":"2025-10-22","ns":["03","04","20","25","28"]},
            {"de":"2025-10-21","ns":["13","22","30","37","38"]},
            {"de":"2025-10-20","ns":["06","13","22","23","27"]},
            {"de":"2025-10-18","ns":["02","17","32","35","38"]},
            {"de":"2025-10-17","ns":["01","21","31","32","34"]},
            {"de":"2025-10-16","ns":["04","18","21","30","37"]},
            {"de":"2025-10-15","ns":["04","07","19","33","39"]},
            {"de":"2025-10-14","ns":["04","05","09","18","24"]},
            {"de":"2025-10-13","ns":["08","13","14","22","36"]},
            {"de":"2025-10-11","ns":["04","09","19","22","34"]},
            {"de":"2025-10-10","ns":["03","06","24","31","36"]},
            {"de":"2025-10-09","ns":["02","04","12","15","29"]},
            {"de":"2025-10-08","ns":["03","09","26","38","39"]},
            {"de":"2025-10-07","ns":["01","16","20","28","34"]},
            {"de":"2025-10-06","ns":["03","05","06","12","13"]},
            {"de":"2025-10-04","ns":["03","04","10","18","39"]},
            {"de":"2025-10-03","ns":["10","16","19","21","28"]},
            {"de":"2025-10-02","ns":["10","19","25","36","39"]},
            {"de":"2025-10-01","ns":["03","05","12","22","27"]}
        ];

        window.onload = function() {
            const ctx = document.getElementById('lottoChart').getContext('2d');
            const dateLabels = a.map(item => item.de);
            const points = [];

            a.forEach(row => {
                row.ns.forEach(num => {
                    points.push({ x: parseInt(num), y: row.de });
                });
            });

            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        data: points,
                        backgroundColor: 'red',
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            position: 'top',
                            min: 1, max: 39,
                            ticks: { stepSize: 1, callback: v => v < 10 ? '0'+v : v },
                            grid: { display: true }
                        },
                        y: {
                            type: 'category',
                            labels: dateLabels,
                            ticks: { autoSkip: false }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        };
    </script>
</body>
</html>

    if(!match) return alert("格式不對喔！");

    let d = match[1], ns = [match[2],match[3],match[4],match[5],match[6]];
    let t = JSON.parse(localStorage.getItem('lib_t')) || baseTimes;
    let n = JSON.parse(localStorage.getItem('lib_n')) || baseN100;
    let d26 = JSON.parse(localStorage.getItem('lib_d')) || baseN26;

    // 處理重複日期：先刪除舊的
    for(let i=d26.length-1; i>=0; i--) if(d26[i][0] === d) d26.splice(i,1);
    if(n[0] === d) { let old = n.splice(1,1)[0]; old.forEach(num => t[Number(num)]--); }

    // 進一出一
    if(n.length >= 101) { let out = n.pop(); out.forEach(num => t[Number(num)]--); }
    n[0] = d; n.splice(1,0,ns);
    ns.forEach(num => t[Number(num)]++);
    t[0] = [d, ...ns]; d26.unshift([d, ...ns]);

    // 儲存並渲染
    localStorage.setItem('lib_t', JSON.stringify(t));
    localStorage.setItem('lib_n', JSON.stringify(n));
    localStorage.setItem('lib_d', JSON.stringify(d26));
    render(t, n, d26);
    document.getElementById('rawInput').value = "";
    alert(d + " 對帳成功！數據已鎖定。");
}

function render(t, n, d) {
    document.getElementById('out_t').value = `var times = [\n  ${JSON.stringify(t[0])},\n  ${t.slice(1).join(", ")}\n];`;
    document.getElementById('out_n').value = `var n100n = [\n  "${n[0]}",\n${n.filter(Array.isArray).map(r => `  ${JSON.stringify(r)}`).join(",\n")}\n];`;
    document.getElementById('out_d').value = `var n26n = [\n${d.map(r => `  ${JSON.stringify(r)}`).join(",\n")}\n];`;
}

function copy(id) { let el = document.getElementById(id); el.select(); document.execCommand("copy"); alert("複製成功！"); }
</script>
</body>
</html>


