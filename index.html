<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>539 走勢圖 - ny.js 版</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="ny.js"></script>
    <style>
        body { background-color: #f4f4f4; margin: 0; padding: 0; }
        .chart-box { background: white; margin: 10px; padding: 20px; border-radius: 12px; }
        .chart-wrapper { width: 100%; height: 3500px; position: relative; }
    </style>
</head>
<body>
    <div class="chart-box">
        <h2 id="title" style="text-align: center; font-size: 20px;">539 走勢圖 (載入中...)</h2>
        <div class="chart-wrapper">
            <canvas id="lottoChart"></canvas>
        </div>
    </div>

    <script>
        window.onload = function() {
            // 檢查變數 a 是否成功從 ny.js 載入
            if (typeof a === 'undefined') {
                document.getElementById('title').innerText = "錯誤：抓不到 ny.js 的數據！";
                document.getElementById('title').style.color = "red";
                alert("抓不到 ny.js！請檢查檔名是否正確，且內容是否有 var a = ");
                return;
            }

            document.getElementById('title').innerText = "539 走勢圖 (V6)";

            const ctx = document.getElementById('lottoChart').getContext('2d');
            const shortDateLabels = a.map(item => item.de.substring(5));
            const scatterPoints = [];

            a.forEach(row => {
                row.ns.forEach(num => {
                    scatterPoints.push({ x: parseInt(num), y: row.de.substring(5) });
                });
            });

            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        data: scatterPoints,
                        backgroundColor: 'red',
                        pointRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            position: 'top',
                            min: 0, max: 40, // 左右留空，保證不切邊
                            ticks: { 
                                stepSize: 1, 
                                font: { size: 16, weight: 'bold' },
                                callback: v => (v > 0 && v < 40) ? (v < 10 ? '0'+v : v) : ''
                            },
                            grid: { display: true }
                        },
                        y: {
                            type: 'category',
                            labels: shortDateLabels,
                            ticks: { autoSkip: false, font: { size: 14 } }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        };
    </script>
</body>
</html>
